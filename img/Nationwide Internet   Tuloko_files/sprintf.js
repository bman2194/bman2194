(function(e){function n(){var e=arguments[0],t=n.cache;if(!t[e]||!t.hasOwnProperty(e))t[e]=n.parse(e);return n.format.call(null,t[e],arguments)}function i(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function s(e,t){return Array(t+1).join(e)}var t={not_string:/[^s]/,number:/[dief]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fiosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};n.format=function(e,r){var o=1,u=e.length,a="",f,l=[],c,h,p,d,v,m,g=!0,y="";for(c=0;c<u;c++){a=i(e[c]);if(a==="string")l[l.length]=e[c];else if(a==="array"){p=e[c];if(p[2]){f=r[o];for(h=0;h<p[2].length;h++){if(!f.hasOwnProperty(p[2][h]))throw new Error(n("[sprintf] property '%s' does not exist",p[2][h]));f=f[p[2][h]]}}else p[1]?f=r[p[1]]:f=r[o++];i(f)=="function"&&(f=f());if(t.not_string.test(p[8])&&i(f)!="number"&&isNaN(f))throw new TypeError(n("[sprintf] expecting number but found %s",i(f)));t.number.test(p[8])&&(g=f>=0);switch(p[8]){case"b":f=f.toString(2);break;case"c":f=String.fromCharCode(f);break;case"d":case"i":f=parseInt(f,10);break;case"e":f=p[7]?f.toExponential(p[7]):f.toExponential();break;case"f":f=p[7]?parseFloat(f).toFixed(p[7]):parseFloat(f);break;case"o":f=f.toString(8);break;case"s":f=(f=String(f))&&p[7]?f.substring(0,p[7]):f;break;case"u":f>>>=0;break;case"x":f=f.toString(16);break;case"X":f=f.toString(16).toUpperCase()}t.number.test(p[8])&&(!g||p[3])?(y=g?"+":"-",f=f.toString().replace(t.sign,"")):y="",v=p[4]?p[4]==="0"?"0":p[4].charAt(1):" ",m=p[6]-(y+f).length,d=p[6]?m>0?s(v,m):"":"",l[l.length]=p[5]?y+f+d:v==="0"?y+d+f:d+y+f}}return l.join("")},n.cache={},n.parse=function(e){var n=e,r=[],i=[],s=0;while(n){if((r=t.text.exec(n))!==null)i[i.length]=r[0];else if((r=t.modulo.exec(n))!==null)i[i.length]="%";else{if((r=t.placeholder.exec(n))===null)throw new SyntaxError("[sprintf] unexpected placeholder");if(r[2]){s|=1;var o=[],u=r[2],a=[];if((a=t.key.exec(u))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");o[o.length]=a[1];while((u=u.substring(a[0].length))!=="")if((a=t.key_access.exec(u))!==null)o[o.length]=a[1];else{if((a=t.index_access.exec(u))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");o[o.length]=a[1]}r[2]=o}else s|=2;if(s===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");i[i.length]=r}n=n.substring(r[0].length)}return i};var r=function(e,t,r){return r=(t||[]).slice(0),r.splice(0,0,e),n.apply(null,r)};typeof exports!="undefined"?(exports.sprintf=n,exports.vsprintf=r):(e.sprintf=n,e.vsprintf=r,typeof define=="function"&&define.amd&&define([],function(){return{sprintf:n,vsprintf:r}}))})(typeof window=="undefined"?this:window);